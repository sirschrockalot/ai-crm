# Story 5.1: Migrate Dashboard Components and Widgets

## Story Information
- **Story ID**: 5.1
- **Title**: Migrate Dashboard Components and Widgets
- **Epic**: Dashboard Feature Migration
- **Sprint**: Sprint 6
- **Priority**: Medium
- **Story Points**: 6
- **Status**: Draft

## Description
Migrate all dashboard components and widgets to the monolithic structure, preserving real-time data updates, notification functionality, and widget customization while integrating with the shared component library.

## Acceptance Criteria
- [ ] **AC 1**: Migrate all dashboard components (widgets, notifications, overview panels)
- [ ] **AC 2**: Preserve all real-time data updates and refresh capabilities
- [ ] **AC 3**: Update components to use shared design system
- [ ] **AC 4**: Maintain dashboard widget customization functionality
- [ ] **AC 5**: Ensure all dashboard interactions work correctly
- [ ] **AC 6**: Update styling to use Chakra UI design system

## Tasks

### Task 1: Migrate dashboard widgets (AC: 1)
- [ ] Migrate data overview widgets (leads, buyers, revenue)
- [ ] Migrate performance metric widgets (KPIs, charts)
- [ ] Migrate activity feed and notification widgets
- [ ] Migrate quick action widgets
- [ ] Migrate status and progress widgets
- [ ] Ensure all widget interactions work correctly

### Task 2: Migrate notification components (AC: 1)
- [ ] Migrate notification center component
- [ ] Migrate real-time notification display
- [ ] Migrate notification preferences and settings
- [ ] Preserve notification history and management
- [ ] Maintain notification priority and categorization
- [ ] Ensure notification delivery and display work correctly

### Task 3: Preserve real-time updates (AC: 2)
- [ ] Migrate WebSocket connections for real-time data
- [ ] Preserve real-time widget data updates
- [ ] Maintain live notification delivery
- [ ] Implement proper data refresh mechanisms
- [ ] Preserve real-time status indicators
- [ ] Ensure real-time performance monitoring

### Task 4: Update to shared design system (AC: 3, 6)
- [ ] Replace custom styling with Chakra UI components
- [ ] Use shared Button, Card, Badge components
- [ ] Implement consistent widget layouts and spacing
- [ ] Use shared loading and error states
- [ ] Apply consistent color scheme and typography
- [ ] Ensure responsive design works across all widgets

### Task 5: Maintain widget customization (AC: 4)
- [ ] Preserve widget drag-and-drop functionality
- [ ] Maintain widget resizing and positioning
- [ ] Preserve widget configuration and settings
- [ ] Maintain widget data source configuration
- [ ] Preserve widget theme and appearance options
- [ ] Ensure widget preferences are saved and restored

### Task 6: Verify dashboard interactions (AC: 5)
- [ ] Test widget interactions and drill-downs
- [ ] Verify notification interactions and management
- [ ] Test real-time data updates and refresh
- [ ] Validate widget customization and configuration
- [ ] Test dashboard layout and responsive behavior
- [ ] Ensure all dashboard features work seamlessly

## Dev Notes

### Previous Story Insights
This story depends on Stories 1.1, 1.2, and all previous epics being completed. The foundation includes:
- Monolithic Next.js application structure with TypeScript
- Shared component library with UI components, layout components, and form components
- Lead management, analytics, and automation features already migrated
- Shared hooks and utilities for data handling and state management
- Design system with Chakra UI theme

### Data Models
Based on the architecture and previous stories:
- **Dashboard Widget Models**: Widget configuration and data structures
- **Notification Models**: Notification data and user preferences
- **Real-time Models**: WebSocket data structures for live updates
- **Customization Models**: User dashboard preferences and layouts

### API Specifications
The dashboard components will integrate with:
- **Dashboard API**: `/api/dashboard` for dashboard data [Source: Architecture_Overview_Wholesaling_CRM.md#Backend Structure]
- **Widget API**: `/api/widgets` for widget data and configuration
- **Notification API**: `/api/notifications` for notification management
- **Real-time API**: WebSocket connections for live updates
- **User Preferences API**: `/api/preferences` for dashboard customization

### Component Specifications
The dashboard components will use existing components from Story 1.2:
- **UI Components**: Card, Badge, Button, Modal for widget interfaces
- **Layout Components**: Sidebar, Header, Navigation for dashboard layout
- **Chart Components**: Chart component for data visualization
- **Loading Components**: Loading component for data loading states
- **Error Components**: Error boundary and error display patterns

### File Locations
Based on the current project structure from Story 1.2:

```
src/frontend/
├── components/
│   ├── dashboard/
│   │   ├── Dashboard.tsx             # Main dashboard component
│   │   ├── DashboardWidget.tsx       # Base widget component
│   │   ├── DataOverviewWidget.tsx    # Data overview widget
│   │   ├── PerformanceWidget.tsx     # Performance metrics widget
│   │   ├── ActivityFeedWidget.tsx    # Activity feed widget
│   │   ├── NotificationWidget.tsx    # Notification widget
│   │   ├── QuickActionWidget.tsx     # Quick action widget
│   │   └── StatusWidget.tsx          # Status and progress widget
│   ├── notifications/
│   │   ├── NotificationCenter.tsx    # Notification center
│   │   ├── NotificationItem.tsx      # Individual notification
│   │   └── NotificationSettings.tsx  # Notification preferences
│   ├── ui/
│   │   ├── Card.tsx                  # Shared card component (already exists)
│   │   ├── Badge.tsx                 # Shared badge component (already exists)
│   │   ├── Button.tsx                # Shared button component (already exists)
│   │   └── Chart.tsx                 # Shared chart component (already exists)
│   └── layout/
│       ├── Sidebar.tsx               # Dashboard navigation (update)
│       └── Header.tsx                # Dashboard header (update)
├── hooks/
│   ├── useDashboard.ts               # Dashboard data hook (create)
│   ├── useNotifications.ts           # Notification hook (create)
│   └── useRealTime.ts                # Real-time data hook (create)
├── pages/
│   └── dashboard.tsx                 # Main dashboard page (update)
└── utils/
    ├── dashboard.ts                  # Dashboard utilities (create)
    └── notifications.ts              # Notification utilities (create)
```

### Testing Requirements
Based on the architecture and previous story context:
- **Unit Tests**: Test all dashboard components and widgets
- **Integration Tests**: Test real-time data updates and notifications
- **E2E Tests**: Test complete dashboard workflows
- **Performance Tests**: Test dashboard loading and real-time updates
- **Accessibility Tests**: Test dashboard interfaces for accessibility

### Technical Constraints
From the architecture documentation:
- **Real-time Updates**: WebSocket integration for live data [Source: Architecture_Overview_Wholesaling_CRM.md#Stack Overview]
- **Data Visualization**: Recharts for charts and graphs [Source: Architecture_Overview_Wholesaling_CRM.md#Stack Overview]
- **State Management**: React hooks with proper TypeScript types
- **Responsive Design**: Mobile-first approach with Chakra UI [Source: Architecture_Overview_Wholesaling_CRM.md#Stack Overview]
- **Performance**: Optimized widget rendering and data updates

### Integration Points
The dashboard components must integrate with:
- **Backend Dashboard API**: NestJS dashboard endpoints [Source: Architecture_Overview_Wholesaling_CRM.md#Backend Structure]
- **Real-time Data**: WebSocket connections for live updates
- **Notification Services**: Real-time notification delivery
- **User Preferences**: Dashboard customization and settings
- **Authentication**: Role-based access to dashboard features

### Performance Considerations
From the architecture scalability considerations:
- **Widget Rendering**: Optimized widget component rendering
- **Real-time Updates**: Efficient WebSocket data handling
- **Data Caching**: Implement caching for dashboard data
- **Bundle Optimization**: Minimize dashboard code bundle size
- **Lazy Loading**: Load widgets on demand

### Security Considerations
From the architecture security section:
- **Dashboard Access**: Role-based access to dashboard features
- **Data Privacy**: Ensure sensitive dashboard data is protected
- **Real-time Security**: Secure WebSocket connections
- **User Preferences**: Secure storage of dashboard customizations
- **Notification Security**: Secure notification delivery and management

### Project Structure Notes
The current project structure from Story 1.2 includes:
- `src/frontend/components/ui/` - 7 core UI components including Chart component
- `src/frontend/components/layout/` - 4 layout components
- `src/frontend/hooks/` - 8 custom hooks
- `src/frontend/utils/` - 5 utility modules
- `src/frontend/pages/` - Feature pages

The dashboard components must preserve this structure while providing comprehensive dashboard functionality with real-time updates and proper integration to the shared component library.

## Integration Verification
- **IV1**: Verify all dashboard widgets display correctly with real-time data
- **IV2**: Confirm real-time updates and notifications work as expected
- **IV3**: Ensure dashboard widget customization and interactions work properly

## Next Steps
After completion of this story, the dashboard components and widgets will be fully migrated to the monolithic structure. The next story (Story 5.2: Migrate Dashboard Pages and Layouts) can proceed with migrating dashboard pages and layout management. 